{"ast":null,"code":"import _objectSpread from \"/Users/ferncliffadmin/clawd/projects/thesalessherpa/src/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _objectWithoutProperties from \"/Users/ferncliffadmin/clawd/projects/thesalessherpa/src/client/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nconst _excluded = [\"name\", \"initialValues\", \"fields\", \"form\", \"preserve\", \"children\", \"component\", \"validateMessages\", \"validateTrigger\", \"onValuesChange\", \"onFieldsChange\", \"onFinish\", \"onFinishFailed\", \"clearOnDestroy\"];\nfunction _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\nimport * as React from 'react';\nimport useForm from \"./hooks/useForm\";\nimport FieldContext, { HOOK_MARK } from \"./FieldContext\";\nimport FormContext from \"./FormContext\";\nimport { isSimilar } from \"./utils/valueUtil\";\nimport ListContext from \"./ListContext\";\nconst Form = (_ref, ref) => {\n  let {\n      name,\n      initialValues,\n      fields,\n      form,\n      preserve,\n      children,\n      component: Component = 'form',\n      validateMessages,\n      validateTrigger = 'onChange',\n      onValuesChange,\n      onFieldsChange,\n      onFinish,\n      onFinishFailed,\n      clearOnDestroy\n    } = _ref,\n    restProps = _objectWithoutProperties(_ref, _excluded);\n  const nativeElementRef = React.useRef(null);\n  const formContext = React.useContext(FormContext);\n\n  // We customize handle event since Context will makes all the consumer re-render:\n  // https://reactjs.org/docs/context.html#contextprovider\n  const [formInstance] = useForm(form);\n  const {\n    useSubscribe,\n    setInitialValues,\n    setCallbacks,\n    setValidateMessages,\n    setPreserve,\n    destroyForm\n  } = formInstance.getInternalHooks(HOOK_MARK);\n\n  // Pass ref with form instance\n  React.useImperativeHandle(ref, () => _objectSpread(_objectSpread({}, formInstance), {}, {\n    nativeElement: nativeElementRef.current\n  }));\n\n  // Register form into Context\n  React.useEffect(() => {\n    formContext.registerForm(name, formInstance);\n    return () => {\n      formContext.unregisterForm(name);\n    };\n  }, [formContext, formInstance, name]);\n\n  // Pass props to store\n  setValidateMessages(_objectSpread(_objectSpread({}, formContext.validateMessages), validateMessages));\n  setCallbacks({\n    onValuesChange,\n    onFieldsChange: function (changedFields) {\n      formContext.triggerFormChange(name, changedFields);\n      if (onFieldsChange) {\n        for (var _len = arguments.length, rest = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          rest[_key - 1] = arguments[_key];\n        }\n        onFieldsChange(changedFields, ...rest);\n      }\n    },\n    onFinish: values => {\n      formContext.triggerFormFinish(name, values);\n      if (onFinish) {\n        onFinish(values);\n      }\n    },\n    onFinishFailed\n  });\n  setPreserve(preserve);\n\n  // Set initial value, init store value when first mount\n  const mountRef = React.useRef(null);\n  setInitialValues(initialValues, !mountRef.current);\n  if (!mountRef.current) {\n    mountRef.current = true;\n  }\n\n  // ========================== Unmount ===========================\n  React.useEffect(() => () => destroyForm(clearOnDestroy),\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  []);\n\n  // Prepare children by `children` type\n  let childrenNode;\n  const childrenRenderProps = typeof children === 'function';\n  if (childrenRenderProps) {\n    const values = formInstance.getFieldsValue(true);\n    childrenNode = children(values, formInstance);\n  } else {\n    childrenNode = children;\n  }\n\n  // Not use subscribe when using render props\n  useSubscribe(!childrenRenderProps);\n\n  // Listen if fields provided. We use ref to save prev data here to avoid additional render\n  const prevFieldsRef = React.useRef(null);\n  React.useEffect(() => {\n    if (!isSimilar(prevFieldsRef.current || [], fields || [])) {\n      formInstance.setFields(fields || []);\n    }\n    prevFieldsRef.current = fields;\n  }, [fields, formInstance]);\n\n  // =========================== Render ===========================\n  const formContextValue = React.useMemo(() => _objectSpread(_objectSpread({}, formInstance), {}, {\n    validateTrigger\n  }), [formInstance, validateTrigger]);\n  const wrapperNode = /*#__PURE__*/React.createElement(ListContext.Provider, {\n    value: null\n  }, /*#__PURE__*/React.createElement(FieldContext.Provider, {\n    value: formContextValue\n  }, childrenNode));\n  if (Component === false) {\n    return wrapperNode;\n  }\n  return /*#__PURE__*/React.createElement(Component, _extends({}, restProps, {\n    ref: nativeElementRef,\n    onSubmit: event => {\n      event.preventDefault();\n      event.stopPropagation();\n      formInstance.submit();\n    },\n    onReset: event => {\n      var _restProps$onReset;\n      event.preventDefault();\n      formInstance.resetFields();\n      (_restProps$onReset = restProps.onReset) === null || _restProps$onReset === void 0 || _restProps$onReset.call(restProps, event);\n    }\n  }), wrapperNode);\n};\nexport default Form;","map":{"version":3,"names":["_extends","Object","assign","bind","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","React","useForm","FieldContext","HOOK_MARK","FormContext","isSimilar","ListContext","Form","_ref","ref","name","initialValues","fields","form","preserve","children","component","Component","validateMessages","validateTrigger","onValuesChange","onFieldsChange","onFinish","onFinishFailed","clearOnDestroy","restProps","_objectWithoutProperties","_excluded","nativeElementRef","useRef","formContext","useContext","formInstance","useSubscribe","setInitialValues","setCallbacks","setValidateMessages","setPreserve","destroyForm","getInternalHooks","useImperativeHandle","_objectSpread","nativeElement","current","useEffect","registerForm","unregisterForm","changedFields","triggerFormChange","_len","rest","Array","_key","values","triggerFormFinish","mountRef","childrenNode","childrenRenderProps","getFieldsValue","prevFieldsRef","setFields","formContextValue","useMemo","wrapperNode","createElement","Provider","value","onSubmit","event","preventDefault","stopPropagation","submit","onReset","_restProps$onReset","resetFields"],"sources":["/Users/ferncliffadmin/clawd/projects/thesalessherpa/src/client/node_modules/@rc-component/form/es/Form.js"],"sourcesContent":["function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nimport * as React from 'react';\nimport useForm from \"./hooks/useForm\";\nimport FieldContext, { HOOK_MARK } from \"./FieldContext\";\nimport FormContext from \"./FormContext\";\nimport { isSimilar } from \"./utils/valueUtil\";\nimport ListContext from \"./ListContext\";\nconst Form = ({\n  name,\n  initialValues,\n  fields,\n  form,\n  preserve,\n  children,\n  component: Component = 'form',\n  validateMessages,\n  validateTrigger = 'onChange',\n  onValuesChange,\n  onFieldsChange,\n  onFinish,\n  onFinishFailed,\n  clearOnDestroy,\n  ...restProps\n}, ref) => {\n  const nativeElementRef = React.useRef(null);\n  const formContext = React.useContext(FormContext);\n\n  // We customize handle event since Context will makes all the consumer re-render:\n  // https://reactjs.org/docs/context.html#contextprovider\n  const [formInstance] = useForm(form);\n  const {\n    useSubscribe,\n    setInitialValues,\n    setCallbacks,\n    setValidateMessages,\n    setPreserve,\n    destroyForm\n  } = formInstance.getInternalHooks(HOOK_MARK);\n\n  // Pass ref with form instance\n  React.useImperativeHandle(ref, () => ({\n    ...formInstance,\n    nativeElement: nativeElementRef.current\n  }));\n\n  // Register form into Context\n  React.useEffect(() => {\n    formContext.registerForm(name, formInstance);\n    return () => {\n      formContext.unregisterForm(name);\n    };\n  }, [formContext, formInstance, name]);\n\n  // Pass props to store\n  setValidateMessages({\n    ...formContext.validateMessages,\n    ...validateMessages\n  });\n  setCallbacks({\n    onValuesChange,\n    onFieldsChange: (changedFields, ...rest) => {\n      formContext.triggerFormChange(name, changedFields);\n      if (onFieldsChange) {\n        onFieldsChange(changedFields, ...rest);\n      }\n    },\n    onFinish: values => {\n      formContext.triggerFormFinish(name, values);\n      if (onFinish) {\n        onFinish(values);\n      }\n    },\n    onFinishFailed\n  });\n  setPreserve(preserve);\n\n  // Set initial value, init store value when first mount\n  const mountRef = React.useRef(null);\n  setInitialValues(initialValues, !mountRef.current);\n  if (!mountRef.current) {\n    mountRef.current = true;\n  }\n\n  // ========================== Unmount ===========================\n  React.useEffect(() => () => destroyForm(clearOnDestroy),\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  []);\n\n  // Prepare children by `children` type\n  let childrenNode;\n  const childrenRenderProps = typeof children === 'function';\n  if (childrenRenderProps) {\n    const values = formInstance.getFieldsValue(true);\n    childrenNode = children(values, formInstance);\n  } else {\n    childrenNode = children;\n  }\n\n  // Not use subscribe when using render props\n  useSubscribe(!childrenRenderProps);\n\n  // Listen if fields provided. We use ref to save prev data here to avoid additional render\n  const prevFieldsRef = React.useRef(null);\n  React.useEffect(() => {\n    if (!isSimilar(prevFieldsRef.current || [], fields || [])) {\n      formInstance.setFields(fields || []);\n    }\n    prevFieldsRef.current = fields;\n  }, [fields, formInstance]);\n\n  // =========================== Render ===========================\n  const formContextValue = React.useMemo(() => ({\n    ...formInstance,\n    validateTrigger\n  }), [formInstance, validateTrigger]);\n  const wrapperNode = /*#__PURE__*/React.createElement(ListContext.Provider, {\n    value: null\n  }, /*#__PURE__*/React.createElement(FieldContext.Provider, {\n    value: formContextValue\n  }, childrenNode));\n  if (Component === false) {\n    return wrapperNode;\n  }\n  return /*#__PURE__*/React.createElement(Component, _extends({}, restProps, {\n    ref: nativeElementRef,\n    onSubmit: event => {\n      event.preventDefault();\n      event.stopPropagation();\n      formInstance.submit();\n    },\n    onReset: event => {\n      event.preventDefault();\n      formInstance.resetFields();\n      restProps.onReset?.(event);\n    }\n  }), wrapperNode);\n};\nexport default Form;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}